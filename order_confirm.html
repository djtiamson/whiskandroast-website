<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Whisk and Roast</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Free HTML Templates" name="keywords">
    <meta content="Free HTML Templates" name="description">

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="lib/lightbox/css/lightbox.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/style.css" rel="stylesheet">

    <style>
        .cart-item {
             display: flex;
             align-items: center; 
             margin-bottom: 10px;
         }

        .cart-item img {
            width: 100px;
            height: 100px;
            margin-right: 10px;
        }
        .cart-item h6{
            margin: 10 10px; 
            color: aliceblue;
            width: 170px;        
        }

        .cart-item .price {
            margin: 10 10px; 
            color: aliceblue;
            width: 170px;
            text-indent: 107px;
        }
    </style>
</head>

<body>
    <!-- Topbar Start -->
    <div class="container-fluid bg-primary py-3">
        <div class="container">
            <div class="row">
                <div class="col-md-6 text-center text-lg-left mb-2 mb-lg-0">
                    <div class="d-inline-flex align-items-center">
                        <a class="text-white pl-3" href="mailto:dannahjanelle.tiamson@tup.edu.ph">Support Team</a>
                    </div>   
                </div>
                <div class="col-md-6 text-center text-lg-right">
                    <div class="d-inline-flex align-items-center">
                        <a class="text-white px-3" href="https://www.facebook.com/profile.php?id=61565706737046&mibextid=ZbWKwL">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a class="text-white px-3" href="https://www.instagram.com/whiskandroast?igsh=MWIwaGVxdmFtazR0bg==">
                            <i class="fab fa-instagram"></i>
                       </a>
                    </div>
                </div>                
            </div>
        </div>
    </div>
    <!-- Topbar End -->


    <!-- Navbar Start -->
    <div class="container-fluid position-relative nav-bar p-0">
        <div class="container-lg position-relative p-0 px-lg-3" style="z-index: 9;">
            <nav class="navbar navbar-expand-lg bg-white navbar-light shadow p-lg-0">
                <a href="index.html" class="navbar-brand d-block d-lg-none">
                    <h1 class="m-0 display-4 text-primary"><span class="text-secondary">Whisk</span>Roast</h1>                </a>
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
                    <div class="navbar-nav ml-auto py-0">
                        <a href="index.html" class="nav-item nav-link">Home</a>
                        <a href="about.html" class="nav-item nav-link">About</a>
                        <a href="product.html" class="nav-item nav-link">Products</a>
                    </div>
                    <a href="index.html" class="navbar-brand mx-5 d-none d-lg-block">
                        <img src="./home/whiskandroastlogo-nobg.png" alt="WhiskadnRoast Logo" style="max-height: 4rem; max-width: 100%;">
                    </a>
                    <div class="navbar-nav mr-auto py-0">
                        <a href="gallery.html" class="nav-item nav-link">Gallery</a>
                        <a href="ratings.html" class="nav-item nav-link">Ratings</a>
                        <a href="contact.html" class="nav-item nav-link">Contact</a>
                    </div>
                </div>
            </nav>
        </div>
    </div><br>
    <!-- Navbar End -->


    <!-- Header Start 
    <div class="jumbotron jumbotron-fluid page-header" style="margin-bottom: 90px;">
        <div class="container text-center py-5">
            <h1 class="text-white display-3 mt-lg-5">Contact</h1>
            <div class="d-inline-flex align-items-center text-white">
                <p class="m-0"><a class="text-white" href="">Home</a></p>
                <i class="fa fa-circle px-3"></i>
                <p class="m-0">Contact</p>
            </div>
        </div>
    </div>
     Header End -->

    <div class="info-box">
        <div class="form">
            <div class="order-info">
                <div class="cust-info">
                    <h5 class="font-weight-bold mb-2">Order Confirmation</h5>
                    <p class="mb-0">Thank you for your purchase at Whisk and Roast!</p><br>
                    <p class="mb-0">We have received your information. Please check your order summary before confirming payment and order.</p><br><hr>
                    <h5 class="font-weight-bold mb-2">Customer Information</h5>
    <p class="mb-2">Email: <span id="emailDisplay"></span></p>
    <p class="mb-2">Phone Number: <span id="pnumDisplay"></span></p>
    <p class="mb-2">First Name: <span id="firstNameDisplay"></span></p>
    <p class="mb-2">Last Name: <span id="lastNameDisplay"></span></p>
    <p class="mb-2">Address: <span id="deliveryAddDisplay"></span></p>
    <p class="mb-2">City: <span id="cityDisplay"></span></p>
    <p class="mb-2">Notes: <span id="notesDisplay"></span></p>

    <form id="orderForm" action="order_confirm.php" method="POST">
        <input type="hidden" name="email" id="emailInput">
        <input type="hidden" name="pnum" id="pnumInput">
        <input type="hidden" name="firstName" id="firstNameInput">
        <input type="hidden" name="lastName" id="lastNameInput">
        <input type="hidden" name="deliveryAdd" id="deliveryAddInput">
        <input type="hidden" name="city" id="cityInput">
        <input type="hidden" name="notes" id="notesInput">
        <input type="hidden" name="cartSummary" id="cartSummaryInput">
        <input type="hidden" name="subtotal" id="subtotalInput">
    
        <hr>
        <button type="submit" class="btn btn-primary btn-block py-3" onclick="document.location='payment.html'">Submit Order</button>
        <!--<button id="proceedToPaymentBtn" type="button" class="btn btn-primary btn-block py-3 px-5" disabled onclick="document.location='payment.html'">Proceed to Payment</button>-->

    </form>
    <div id="response"></div>
                </div>
                
            </div>
            <div class="order-form">
                <div class="os">
                                <div class="product-info">                                           
                            <div>
                                <h5 class="price-white">Order Summary</h1>
    <div id="cart-summary" style="max-height: 300px; overflow-y: auto; padding-right: 10px;">
        <!-- Cart items will be dynamically inserted here -->
    </div>
     
                                <!--<h5 class="title">Americano</h5>
                                <p class="price-white">Price: â‚±100.00</p>
                                <a class="price-white" href="">Remove <!--remove product from order summary--> </a>                       
                            </div>
                            </div>

                    <hr color="white">
                    <div class="os">

                                    <p class="price-white" style="text-align-last: justify;" id="subtotal">Subtotal: $0.00</p> <!-- Subtotal display -->

                        
                    </div>
                    
                </div>
                
            </div>
        </div>
    </div>





    <!-- Footer Start -->
    <div class="container-fluid footer bg-light py-5" style="margin-top: 90px;">
        <div class="container text-center py-5">
            <div class="row">
                <div class="col-12 mb-4">
                    <a href="index.html" class="navbar-brand m-0">
                        <h1 class="m-0 mt-n2 display-4 text-primary">Whisk <span class="text-secondary">and</span> Roast</h1>
                    </a>
                </div>
                <div class="col-12 mb-4">
                    <a class="btn btn-outline-secondary btn-social mr-2" href="https://www.facebook.com/profile.php?id=61565706737046" target="_blank">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a class="btn btn-outline-secondary btn-social" href="https://www.instagram.com/whiskandroast?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==" target="_blank">
                        <i class="fab fa-instagram"></i>
                    </a>
                </div>
                <div class="col-12 mt-2 mb-4">
                    <div class="row">
                        <div class="col-sm-6 text-center text-sm-right border-right mb-3 mb-sm-0">
                            <h5 class="font-weight-bold mb-2">Get In Touch</h5>
                            <p class="mb-2">Ilaya, Alabang, Muntinlupa City</p>
                            <p class="mb-0">09389864783</p>
                        </div>
                        <div class="col-sm-6 text-center text-sm-left">
                            <h5 class="font-weight-bold mb-2">Opening Hours</h5>
                            <p class="mb-2">Our online store is open 24/7!</p>
                            <p class="mb-0">Shop anytime, anywhere.</p>
                        </div>
                    </div>
                </div>
                <div class="col-12">
                    <p class="m-0">&copy; <a>Whisk and Roast</a>. All Rights Reserved.</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer End -->


    <!-- Back to Top -->
    <a href="#" class="btn btn-secondary px-2 back-to-top"><i class="fa fa-angle-double-up"></i></a>


    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="lib/isotope/isotope.pkgd.min.js"></script>
    <script src="lib/lightbox/js/lightbox.min.js"></script>

    <!-- Contact Javascript File -->
    <script src="mail/jqBootstrapValidation.min.js"></script>
    <script src="mail/contact.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const cartContainer = document.getElementById('cart-summary');
            const subtotalElement = document.getElementById('subtotal'); // Element to display subtotal
    
            // Retrieve the cart data from localStorage
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
    
            // Check if the cart is empty
            if (cart.length === 0) {
                cartContainer.innerHTML = '<p>Your cart is empty.</p>';
                subtotalElement.innerHTML = 'Subtotal: â‚±0.00'; // Show 0 if cart is empty
                return;
            }
    
            // Initialize subtotal variable
            let subtotal = 0;
    
            // Display each cart item
            cart.forEach((item, index) => {
                const cartItemElement = document.createElement('div');
                cartItemElement.classList.add('cart-item');
                cartItemElement.innerHTML = `
                    <img src="${item.imgSrc}" alt="${item.name}">
                    <h6>${item.name}</h6>
                    <span class="price">${item.price}</span>
                    
                `;
    
                cartContainer.appendChild(cartItemElement);
    
                // Calculate subtotal (price * quantity)
                const itemPrice = parseFloat(item.price.replace('â‚±', '').trim()); // Remove 'â‚±' and parse as number
                subtotal += itemPrice ; //* item.quantity Add to subtotal
            });
    
         // Update the subtotal display
         updateSubtotal(cart);    
    
              
    });
    
     // Function to update the cart in localStorage
     function updateCartInLocalStorage(cart) {
            localStorage.setItem('cart', JSON.stringify(cart));
        }
    
        // Function to update the subtotal
        function updateSubtotal(cart) {
            let subtotal = 0;
    
            // Recalculate subtotal
            cart.forEach(item => {
                const itemPrice = parseFloat(item.price.replace('â‚±', '').trim()); // Remove '$' and parse as number
                subtotal += itemPrice ; //* item.quantity Add to subtotal
            });
    
            // Update the subtotal element
            const subtotalElement = document.getElementById('subtotal');
            subtotalElement.innerHTML = `Subtotal: â‚±${subtotal.toFixed(2)}`; // Format to two decimal places
        }
    </script>
  
    <script>  // from temp cust info
        document.addEventListener('DOMContentLoaded', function () {
            // Retrieve the order data from sessionStorage
            const orderData = JSON.parse(sessionStorage.getItem('orderData'));

            // If data exists, populate the confirmation page
            if (orderData) {
                document.getElementById('emailDisplay').textContent = orderData.email;
                document.getElementById('pnumDisplay').textContent = orderData.pnum;
                document.getElementById('firstNameDisplay').textContent = orderData.firstName;
                document.getElementById('lastNameDisplay').textContent = orderData.lastName;
                document.getElementById('deliveryAddDisplay').textContent = orderData.deliveryAdd;
                document.getElementById('cityDisplay').textContent = orderData.city;
                document.getElementById('notesDisplay').textContent = orderData.notes;
            }
        });

        document.addEventListener('DOMContentLoaded', function () {
    const orderData = JSON.parse(sessionStorage.getItem('orderData'));
    const cartData = JSON.parse(localStorage.getItem('cart'));
    const subtotal = document.getElementById('subtotal').textContent.replace('Subtotal: â‚±', '').trim();

    if (orderData) {
        document.getElementById('emailInput').value = orderData.email;
        document.getElementById('pnumInput').value = orderData.pnum;
        document.getElementById('firstNameInput').value = orderData.firstName;
        document.getElementById('lastNameInput').value = orderData.lastName;
        document.getElementById('deliveryAddInput').value = orderData.deliveryAdd;
        document.getElementById('cityInput').value = orderData.city;
        document.getElementById('notesInput').value = orderData.notes;
    }

    // Serialize cart and subtotal
    document.getElementById('cartSummaryInput').value = JSON.stringify(cartData);
    document.getElementById('subtotalInput').value = subtotal;
});
    </script>

<script>
    async function submitOrder(event) {
        event.preventDefault();

        const formData = new FormData(document.getElementById('orderForm'));

        const data = {
            email: formData.get('email'),
            pnum: formData.get('pnum'),
            firstName: formData.get('firstName'),
            lastName: formData.get('lastName'),
            deliveryAdd: formData.get('deliveryAdd'),
            city: formData.get('city'),
            notes: formData.get('notes'),
            cartSummary: formData.get('cartSummary'),
            subtotal: formData.get('subtotal')
        };

        try {
            const response = await fetch('order_confirm.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: new URLSearchParams(data)
            });

            const result = await response.json();
            alert(result.message);
        } catch (error) {
            alert("An error occurred: " + error.message);
        }
    }
</script>
<script>
    document.getElementById('orderForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent form submission

        const formData = new FormData(this);

        fetch('order_confirm.php', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            const responseDiv = document.getElementById('response');
            if (data.success) {
                responseDiv.innerHTML = `<p style="color: green;">${data.message}</p>`;
            } else {
                responseDiv.innerHTML = `<p style="color: red;">${data.message}</p>`;
            }
        })
        .catch(error => {
            console.error('Error:', error);
            document.getElementById('response').innerHTML = '<p style="color: red;">An error occurred while submitting the form.</p>';
        });
    });
</script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const proceedToPaymentBtn = document.getElementById('proceedToPaymentBtn');
        const submitOrderBtn = document.querySelector('#orderForm button[type="submit"]');

        // Initially disable the Proceed to Payment button
        proceedToPaymentBtn.disabled = true;

        // Add event listener for the Submit Order button
        submitOrderBtn.addEventListener('click', function (event) {
            event.preventDefault(); // Prevent the default form submission

            const form = document.getElementById('orderForm');
            const formData = new FormData(form);

            // Validate if required fields are filled
            const isFormValid = [
                formData.get('email'),
                formData.get('pnum'),
                formData.get('firstName'),
                formData.get('lastName'),
                formData.get('deliveryAdd'),
                formData.get('city')
            ].every(field => field && field.trim() !== "");

            if (!isFormValid) {
                alert('Please complete all required fields before proceeding.');
                return;
            }

            // Simulate successful form submission (replace this with your actual form submission logic)
            fetch('order_confirm.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert(data.message);
                    proceedToPaymentBtn.disabled = false; // Enable the Proceed to Payment button
                } else {
                    alert('Error: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred while submitting the form.');
            });
        });
    });
</script>

</body>

</html>